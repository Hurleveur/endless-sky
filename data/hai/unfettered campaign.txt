# Copyright (c) 2021 by Hurleveur
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.



mission "Unfettered: Solifuge 1: Geocoris Design"
	name `Scan the Geocoris`
	description `Scan the outfits of the Hai Geocoris in Ya Hai, then return to <destination> with the scanner logs.`
	source "Firelode"
	waypoint "Ya Hai"
	to offer
		has "Unfettered Jump Drive 2: offered"
		has "Unfettered: Bring Hai: done"
		has "Unfettered: Prove your strenght: done"
	to fail
		has "Wanderers: Jump Drive Source: done"
	on offer
		conversation
			`As you wander in the spaceport an unfettered approaches you. At first you wonder why that is but then you realise that you naturally stand out among the Hai.`
			`	"Captain <last> ! I am Taer-Fi, and I have received the responsibility of mechanics. We have an easy job for you if you are interested,"	She says.`
			choice
				`	"Sure, what can I do for you ?"`
				`	"How do you know me ?"`
					goto know
				`	"Sorry, but I'm quite busy at the moment."`
					decline
			`	"Straight to the point ! I'm starting to like you."`
				goto job
			label know
			`	"Someone who brings us something as precious as a jump drive is not quickly forgotten ! Now back to our business if you don't mind."`
			label job
			`	"As you probably know, the other Hai do not think like us, they have preoccupations other than war, they believe in trading with all the galaxy in harmony forever, without seeing how it softens them. As such, they have wasted time designing a ship for the sole purpose of transporting goods in great quantity : the Geocoris. Or at least that is how it seemed to us at first, it now seems like such a design is... interesting. It is pretty much garanteed there will be one such ship at all times in their home system, Ya-Hai, the center of their trade. For obvious reasons we cannot scan that ship ourselves, and we prefer that the Hai be ignorant of our interest in that design anyway. Scan it and bring the logs back to us."`
			choice
				`	"Seems easy, I will do it."`
					accept
				`	"Why do you want to learn about that ship design all out of a sudden ?"`
				`	"Can you not just ask the Hai that come to you from their space about it ?"`
				`	"I do not want to get in trouble with the Hai."`
					decline
			`	"That is what we will be forced to do if you refuse, but we would prefer if this was kept a secret, without asking everyone about it. Also most Hai joining us are not warriors, but rather poets and others who want to explore other ways of seeing the world.`
			choice
				`	"Seems easy, I will do it."`
					accept
				`	"I do not want to get in trouble with the Hai."`
					decline
			label design
			`	"We would like to know how they avoided vulnerabilities in the hull of such a ship. Extra space on a ship cannot only be used for cargo... I will tell you more about it later, once you bring us the scans, that is if you are willing of course ?"`
			choice
				`	"Sure, will do."`
					accept
				`	"That is way too mysterious for me, I am not interested."`
					decline
		log "People" "Taer-Fi" `An Unfettered specialized in mechanics that seems interested in ship designs of all kind. She seems to like to stay mysterious, and is easily exited by new technologies and ships.`
	npc "scan outfits"
			government "Hai"
			personality target
			system "Ya Hai"
			fleet
				variant
					"Geocoris"
			dialog `You have scanned the Geocoris. You may now return to <destination> with the scanner logs.`
	on waypoint
		dialog `There is indeed a Geocoris in this system, but it seems to be moving, better scan it fast !`
	
	on visit
		dialog `You have not scanned the Geocoris yet, go to the Hai homeworld to scan it and come back here.`
	on complete
		payment 100000
		log `Scanned a Geocoris for the unfettered, they seemed interested in the design.`
		dialog `You send the scans to the unfettered government and receive a payment of <payment>.`



ship "Auxiliary" "Auxiliary (Alpha)"
	sprite "ship/auxiliaryc"
	thumbnail "thumbnail/auxiliaryc"
	outfits
		"Hai Tracker Pod" 2
		"Hai Tracker" 112
		"Korath Disruptor"
		"Korath Slicer Turret"
		"Bullfrog Anti-Missile" 2
		
		"Triple Plasma Core"
		"Systems Core (Large)"
		"Large Heat Shunt" 3
		"Wanderer Ramscoop"
		"Laser Rifle" 138
		
		`"Bufaer" Atomic Thruster`
		"Steering (Stellar Class)"
		"Jump Drive"
	add attributes
		"bunks" -112
		"cargo space" 200
	gun -12 -180 "Hai Tracker Pod"
	gun 12 -180 "Hai Tracker Pod"
	turret 0 -72 "Bullfrog Anti-Missile"
	turret 0 -21 "Korath Disruptor"
	turret 0 31 "Korath Slicer Turret"
	turret 0 83 "Bullfrog Anti-Missile"

mission "Unfettered: Solifuge 2: Auxiliary Design"
	name `Scan the human ship`
	description `Scan the outfits of the human ship in Hi Yahr by <data> and then come back to <destination> with the logs.`
	deadline 6
	source "Firelode"
	waypoint "Hi Yahr"
	to offer
		has "Unfettered: Solifuge 1: Geocoris Design: done"
		has "Unfettered: Jump Drive 3: offered"
		not "Wanderers: Jump Drive Source: active"
	to fail
		has "Wanderers: Jump Drive Source: done"
	on offer
		conversation
			`You go get a drink in the spaceport, thinking about the unfettered you met earlier, Taer-Fi. He said he would tell you more about it once he gets the logs but you have not seen him yet. Hopefully he can be trusted. After an hour of talking with the local unfettered, you see him coming. He seems to be in a hurry.`
			`	"Sorry I could not see you earlier, I was busy. I know I have promised you information about the reason for your mission, but there is a more pressing matter we should focus on. A human ship will enter Hi Yahr soon, I need you to scan it for me, then I will meet you here with the others and answer any questions you may have." He says.`
			`	"Oh and before I forget, watever you do you should not attack them, even if they strike first. I do not know how they will even react to your presence though."`
			choice
				`	"Okay, I better get going right now then."`
					accept
				`	"Why not just do it yourself ?"`
				`	"Sorry, but this seems too risky for me."`
					decline
			`	"We do not know what their reaction could be, it would be preferable if you did it because watever happens they will think of you as independant of us. We value friendship a lot, and once trust is damaged it cannot really be repaired."`
			choice
				`	"Seems good to me, I will do it."`
					accept
				`	"What kind of ship are we talking about ?"`
				`	"Wait you mean they could shoot me ? No way, I am out !"`
					decline
			`He seems anxious to tell you.	"It is a human ship, and quite a big one at that. We do not know it's designation but carries multiple small ships, and uses alien technologies. You do not need to be able to destroy it, just scan it and come back here."`
			choice
				`	"I am not worried about any one ship, I will do it."`
					accept
				`	"That seems way too dangerous to me."`
					decline
	npc save "scan outfits"
		government "Alpha"
		personality timid staying target
		system "Hi Yahr"
		ship "Auxiliary (Alpha)" "Settler"
		dialog `You have finished scanning the Auxiliary. You may now return to <destination> with the scanner logs.`
	
	on visit
		dialog `You have not finished scanning the human ship in Hi Yahr yet, quickly go to Hi Yahr to scan it !`
	on fail
		dialog `You have failed an essential unfettered mission. You may want to reload.`
	on complete
		payment 300000
		log `Scanned a navy carrier for the unfettered, I wonder what it was doing so far from Republic space, and with alien technology.`
		dialog
			`You send your logs as you land and receive a very generous payment of <payment>, with a request to meet with the elders on Darkcloak. You decide to go to the spaceport to gather your thoughts about all of this...`
		conversation
			`You are thinking about how to present the matter to the elders when you hear a voice from the com.	"Oh you are back, good !" You are a bit surprised of the intervention but quickly recognize Taer-Fi. "Can I speak to you before you bring the results to the council ? I am really intrigued as to how that auxiliary could work, and you probably want to wait for the tension to calm down a bit before entering the discussion anyway."`
			choice
				`	"I really want to go speak to the council right now, maybe another time."`
					goto hurry
				`	"Sorry but I am no engineer myself, I have no idea about how those carriers work."`
				`	"Sure, what is it you want to know about them ?"`
			`	"I already have access to the specifications of the ship, my questions are mostly related to how they fare in battle. We have never tried ships carying fighters before because of some ethical, ethical implications and also, to be honnest, of the technical difficulties of building a ship large enough to contain multiple ones. How do they fare, how are they countered ?" He seems very exited to learn about them.`
			choice
				`	"Well I have never seen them in combat personnaly so you will have to ask someone else, I have only heard stories."`
					goto stories
				`	"What you have seen was not really a proper carrier... wait until you see the navy Carriers."`
				`	"Well they are so expensive we do not see too many of them, with the obvious cost of losing fighters all the time... Do not bother with them."`
					goto price
				`	"Oh you mean the version of the ship even more focused on fighters and weapons ? We have already scans of that one, exciting scans ! Tell me more."	She seems to be drinking your words, waiting for more about those carriers.`
			choice
					`	"Carriers dominate in human space, they have weapons to take down any ships and with their fighters they can even take down small fleets."`
					`	"Well I have never seen them in combat personnaly so you will have to ask someone else, I have only heard stories."`
						goto stories
			`	"Yes, my thoughts exactly ! The fighters are too agile to be shot down by the conventional weapons that do not turn, obviously any guns mounted on a turret will easily take the small ships down... Very good ! I was effrayed that having a ship with fighters would mean it would be too limited in it's weaponry, but it seems even you humans have found a way to remedy that." She barrely finishes his phrase before going back to wherever he came for, even more excited than before.`
				goto hurry
			label price
			`	"Yes the price part needs to be adressed... But their strenght is still something to be respected. The best advantage is that the fighters enjoy the ride and do not need independant moving systems !"	She seems a bit disapointed but what you said does not seem to change any big plans for him.`
			label stories
			`	"Yes, so have I and for once the stories were not exagerated, compared to the facts ! I have heard them ever since the Carrier was first seen by our people, it inspired us."`
			label hurry



mission "Unfettered: Solifuge 3: Carrier Discussion"
	name `Proof of alpha attrocities`
	description `Bring back proof of what you say about the alphas from the republic station <waypoint>`
	source "Darkcloak"
	stopover "Earth"
	to offer
		has "Unfettered: Solifuge 2: Auxiliary Design: done"
		not "Wanderers: Jump Drive Source: active"
	to fail
		has "Wanderers: Jump Drive Source: done"
	on offer
		conversation
			`As you enter the spaceport you quickly find the council, it seems like they are waiting for you. It will finally be the time for answers.`
			`One of the leaders steps forward.	"Hopefully this is not too fast for you. Taer-Fi was in such a hurry to get those designs that he monitored your situation as soon as he heard of weapons fire. He has told us of your recent success. We wanted to appologise for putting you in danger, we did not expect you to be ennemy to the green humans."	He says, seemingly happy.`
			choice
				`	"Green humans ? You mean alphas ?? Are you their allies ?"`
			`Another leader comes to you, you recognize Sha-Ri.	"We are very sorry of this misunderstanding, and I can see you are quite worried. We are not their allies they only bring us jump drives, like you do, for a given payment. Also you will be compensated as the nature of the mission we gave you did not include getting attacked by that carrier."`
			choice
				`	"You do not seem to understand, they are dangerous, engineered to kill."`
				`	"It is quite alright, I guess I was just a bit shocked at the news, and did not expect to get shot at."`
					decline
			`	"What do you mean ? According to the stories they told us they seem to fight for the same reasons we do, survival. They do not have a choice, except it is worse, they are being hunted down because of who they are, and have little choice how to respond. To some, you could be viewed as monsters." This seems to be a very sensitive subject, you wonder if you should press the matter further.`
			choice
				`	"They have caused a lot of suffering on our worlds, and do not hesitate to murder civilians if it gets them a bit closer to their goals."`
				`	"It is quite alright, I guess I was just a bit shocked at the news, and did not expect to get shot at."`
					decline
			`Some of the council members are whispering, tension is becoming palpable.	"Very well I am willing to trust you, but first you most bring us proof of such accusations."`
			choice
				`	"I will go to get data on the Alpha wars."`
					accept
				`	"I do not know how to get access to such data, and maybe it is better for you not to make an ennemy of the Alphas."`
					decline
				`	"Anyone who does not shoot alphas on sight is my ennemy. Do not ever contact me again."`
					decline
	on stopover
		dialog `You ask them for a record of everything related to the Alpha wars and they seem more than happy to comply.`
	on visit
		dialog `You landed but you have not gotten the record of the Alpha wars. Come back when you have them, it will probably be available on Earth.`
	on complete
		log `Showed proof to the unfettered of the Alpha attrocities.`


#has to land to drop the reserved cargo ? notice there is nothing on the planet then takeoff
mission "Unfettered: Solifuge 4: Alpha Jump Drives"
	name `Steal Alpha jump drives`
	description `Go to the alpha hidden depot and steal the jump drives. Then bring them back to Darkcloak.`
	source "Darkcloak"
	destination "Hope"
	cargo "(reserved)" 200
	blocked `You will need 200 cargo space for the next unfettered mission.`
	to offer
		has "Unfettered: Solifuge 3: Carrier Discussion: done"
		not "Wanderers: Jump Drive Source: active"
	to fail
		has "Wanderers: Jump Drive Source: done"
	on offer
		conversation
			`You arrive in the spaceport and quickly notice that there is activity, it seems that you have started quite a bit of discussion among the council members. There also seem to be others who joined the discussion, you wonder why. Hopefully they will listen to reason once you show them the records...`
			
			`All discussion seems to stop as you arrive, they apparently noticed the logs you are carrying. "Finally, Captain <last>, you arrive right on time, we were discussing if the alphas could betray us. That is why our warlords are also present, any tactical expertise is sound. It does not seem they have too strong of a military power though, especially considering they seem to have some sworn ennemies..."	The council debates on what he just said, you are amazed by how calm they are staying during all of this, not one of them has gotten up or risen his fist. Except for the younger ones, that is.`
			choice
				`	"I have brought you the records I promised."`
				`	"Actually nevermind I do not think you should be ennemy to the alphas."`
					goto cancel
			`	"We were prepared for that possibility, but wanted to make sure ourselves. There was some interesting information in your scanner logs, we know of the location of their base, far north east, after the territory of the automated murder machines."`
			choice
				`	"I will go and recover all jump drives, one way or the other."`	
					accept
				`	"Actually nevermind I do not think you should be ennemy to the alphas."`
			label cancel
			`	"Actually they would not even know we had anything to do with it, you are the one who scanned their ship after all, and about any expert can extract this information, all they know is we do not shoot you on sight, and for all they are concerned about it can just be because you bring jump drives to us. So are you sure you do not want to do this ?"`
			choice
				`	"I will go and recover all jump drives, one way or the other."`	
					accept
				`	"Yes I am sure we should not do this. It actually looks like a trap, and you do not want to underestimate these Alphas."`
			`He thinks a bit, when he speaks it seems like the others are in agreement. "Well you do seem to know a lot about these alphas, so we will do as you say, better to avoid too many ennemies, especially with what is coming..."`
				decline
	on visit
		dialog `You landed but you have not gotten the Alpha's jump drives yet. Come back when you have them.`
	on fail
		dialog `You have failed an essential unfettered mission. You may want to reload.`



mission "Unfettered: Solifuge 5: Alpha Jump Drives"
	invisible
	name `Steal Alpha jump drives`
	description `Go to the alpha hidden depot and steal the jump drives. Then bring them back to Darkcloak.`
	source "Hope"
	destination "Darkcloak"
	to offer
		has "Unfettered: Solifuge 4A: Alpha Jump Drives: active"
	on offer
		dialog `It seems like their supply ship is in the system, disable it and claim the jump drives for yourself !`
	npc board
		government "Alpha"
		system "Host"
		personality heroic nemesis staying vindictive target
		ship "Auxiliary (Alpha)" "Settler"
			outfit "Jump Drive" 10
		dialog `You have managed to disable their ship, and taken the jump drives, now you may destroy it if you want.`
	npc
		government "Alpha"
		system "Host"
		personality heroic nemesis staying vindictive
		ship "Far Osk 27" "Prancer"
		ship "Far Osk 27" "Vixen"
		ship "Far Lek 14" "Cupid"
		ship "Far Lek 14" "Comet"
	
	on fail
		dialog `You have failed an essential unfettered mission. You may want to reload.`
	on complete
		log `Stole jump drives from the an Alpha auxiliary.`
		dialog `The Unfettered seem surprised to see you, when they adress you they do so with respect,	"It seems like you are a better ally than the Alphas after all. Good ! Now we have enough jump drives for the next phase..."`
		outfit "Jump Drive" -10


# increase the amount of asteroids in the systems ?
mission "Unfettered: Solifuge 6: Materials For Ships"
	name `Gather silicon from asteroids`
	description `Mine and then collect 100 tons of Silicon from the asteroid field in Wah Yoot and 50 tons of Silver from the asteroid field in Ehma Ti and then bring them back to <destination> for <payment>.`
	source "Darkcloak"
	waypoint "Ehma Ti"
	to offer
		has "Unfettered: Solifuge 5: Alpha Jump Drives: done"
		or 
			has "Unfettered: Solifuge 4: Alpha Jump Drives: declined"
	on offer
		conversation
			`You have never seen so much agitation in the Unfettered, until now. It looks like a big event is about to happen, and you will probably be a part of it.	It seems like Taer-Fi is spreading a message to all Unfettered to hear,	"The time has come, brothers and sisters ! Now all that is needed is to spread the world, and our brethren from Hai space will join us in glorious victory ! But let us not be reckless, in order to win we will need ships and in order to get ships we will need materials. That is why we should all start gathering materials here."`
			choice
				`	"What kind of materials do you need ?"`
				`	(Leave, I want no part in this.)`
					decline
			`She notices you and responds to your question by adressing all again,	"Do not bother with copper friends, it is useless for we are not a barbaric people. We need a lot of silver, and silicon."`
			choice
				`	(I know how and where to mine asteroids, better get going.)`
					accept
				`	"How do I even collect minerals from asteroids ?"`
					goto asteroidtuto
				`	"Where can I get those ressources from ?"`
					goto where
				`	(Leave, I do not have time to start looking for those.)`
					decline
			branch auxiliary
				has "Unfettered: Solifuge 5: done"
			`It looks like she is done speaking to the others, now she comes to you and says,	"Hi <first>, it has been a while since I last saw you. Heard you took care of that Auxiliary and brought back quite the treasure, great work ! Now back about your question, allow me to explain."`
			label auxiliary
			`It looks like she is done speaking to the others, now she comes to you and says,	"Hi <first>, back at action I see. Now back about your question, allow me to explain."`
			label asteroidtuto
			`	"You have never mined asteroids ? Well I recommend you got with an asteroid scanner so your ship may target them automatically. Just try to keep your ship stable around one and shoot it as you would any other ships. Keep in mind they are just hull and maybe you don't want to waste missiles on them since they do not shoot back."`
			choice
				`	"I have no more questions, see you soon."`
					accept
				`	"Where can I get those ressources from ?"`
					goto where
				`	"Sorry but I am not a miner."`
					decline
			label where
			`	"That is simple, silicon can be found right over our heads and silver in Ehma Ti. The silicon asteroid look similar to copper but they are bigger, but you can also just differenciate them with an asteroid scanner."`
			choice
				`	"I have no more questions, see you soon."`
					accept
				`	"How do I even collect minerals from asteroids ?"`
					goto asteroidtuto
				`	"Sorry but I am not a miner."`
					decline
	npc
		government "Hai (Unfettered)"
		personality harvests plunders opportunistic
		system "Ya Hai"
		fleet
			variant
				"Shield Beetle"

	npc
		government "Hai (Unfettered)"
		personality harvests plunders opportunistic
		system "Ehma Ti"
		fleet
			variant
				"Shield Beetle"
	
	on complete
		payment 250000
		dialog `You bring your cargo to the local Unfettered shipyards, they hand you <payment> credits. You see a huge ship being built in the distance.`
		outfit "Silicon" -100
		outfit "Silver" -50



mission "Unfettered: The Word Has Spread"
	name `Gather the true Hai`
	description `Now that the Hai know of the Unfettered plan, a lot of them are eager to join them whilst most cower in fear.`
	passengers 216
	source "Firelode"
	blocked `You need 216 passenger space for the next Unfettered mission.`
	to offer
		has "Unfettered: Solifuge 6: Materials for ships: done"
	stopover "Cloudfire"
	on stopover "Cloudfire"
		dialog `These 12 Hai are happy to join you for the big conquests to come.`
	stopover "Snowfeather"
	on stopover "Snowfeather"
		dialog `These 3 Hai are happy to join you for the big conquests to come.`
	stopover "Stonebreak"
	on stopover "Stonebreak"
		dialog `These 25 Hai are happy to join you for the big conquests to come.`
	stopover "Darkmetal"
	on stopover "Darkmetal"
		dialog `These 7 Hai are happy to join you for the big conquests to come.`
	stopover "Makerplace"
	on stopover "Marketplace"
		dialog `These 43 Hai are happy to join you for the big conquests to come.`
	stopover "Mirrorlake"
	on stopover "Mirrorlake"
		dialog `These 5 Hai are happy to join you for the big conquests to come.`
	stopover "Icelake"
	on stopover "Icelake"
		dialog `These 52 Hai are happy to join you for the big conquests to come.`
	stopover "Newhome"
	on stopover "Newhome"
		dialog `These 34 Hai are happy to join you for the big conquests to come.`
	stopover "Greenbloom"
	on stopover "Greenbloom"
		dialog `These 15 Hai are happy to join you for the big conquests to come.`
	stopover "Greenwater"
	on stopover "Greenwater"
		dialog `These 20 Hai are happy to join you for the big conquests to come.`
	on offer
		conversation
			`The recent activity has still not dimnished, people are moving around everywhere, getting to their ships or doing simply their jobs but with renewed purpose. In all that activity you find your elder friend, $$$, who seems more than content with seeing you, and speaks with joy,	"Ah, here you are, when you are most needed like always, <first> ! All true Hai have felt the call to battle now, but some have difficulties joining us because of the Hai government... Could you help getting them here ?"`
			choice
				`	"Sure !"`
					accept
				`	"Why would they want to join you ?"`
				`	"What battle are you even talking about ?"`
					goto battle
				`	"No way, I am not helping your crusade."`
					decline
			label why
			`	"It depends, for some they just to enjoy the resources of the new worlds that are ready for the taking. Others seek inspiration by seeing our soldiers fight. Others still want to join us as civilians now that they are convinced the living conditions will not be as bad in our territory, or as health specialists to mitigate the loss of life."`
			choice
				`	"Let's gather the Hai then."`
					accept
				`	"What battle are you even talking about ?"`
				`	"No way, I am not helping your crusade."`
					decline
			label battle
			`	"The only battle there is, the one you have helped us plan for so long, the reconquest of our lost glory and lost worlds, up north."	He seems to really believe in what he is saying, it looks like the fire of battle has lit once more in him.`
			choice
				`	"Sure ! I will join this battle then."`
				`	"Why would they want to join you ?"`
					goto why
				`	"No way, I am not helping your crusade."`
					decline
			`	"I like your enthousiasm but all things in good time, first you need to bring these people back to their new home."`
	on complete
		payment 5000000
		dialog `The Hai are all excited to join the Unfettered, you did notice that more of them are ready for battle than usual, though. You receive your payment of <payment>.`
	
#if you war Hai somewhere it should be said it is not in your best interest to do it + option to have peace if it blocks the missions, the Hai are for later

#.we downloaded those from your ship as soon as you arrived in orbit, knowing you would not mind. We have seen enough to come to an accord : we will not do any other agreements with the alphas, other than accepting their jump drives"`
